<!-- File: src/app/features/ships/ship-detail.page.html -->
@if (ship(); as s) {
  <ion-content>
    <section class="vds-section">
      <div class="head">
        <vds-badge [series]="s.series">{{ s.code }}</vds-badge>
        <h1 class="vds-h1">{{ s.name }}</h1>
        <span class="vds-chip vds-code">{{ s.class }}</span>
        @if (s.line) {
          <span class="vds-chip vds-code">{{ s.line }}</span>
        }
        <a routerLink="/ships" class="back">Back to Ships</a>
      </div>
      <div class="layout">
        <article class="vds-card prose">
          @if (showViewer) {
            <bh-model-viewer></bh-model-viewer>
          }
          <h2 class="vds-h2">[ DEBRIEF FOR {{s.name}} ]</h2>
          <p>{{ s.summary }}</p>
          <p>{{ s.description }}</p>
        </article>
        <aside class="right">
          <!-- Loading State -->
          @if (loadingStats()) {
            <div class="vds-card loading-state">
              <div class="spinner"></div>
              <p>Loading specifications...</p>
            </div>
          }
          <!-- Error State -->
          @if (statsError()) {
            <div class="vds-card error-state">
              <p>⚠️ {{ statsError() }}</p>
              <button (click)="retryLoadStats()" class="btn">Retry</button>
            </div>
          }
          <!-- Stats Loaded - driven from API via signal -->
          @if (!loadingStats() && !statsError()) {
            <vds-spec-grid
              [specs]="specs()">
            </vds-spec-grid>
          }
          <div class="cta vds-card">
            <a routerLink="/codex" class="btn">View in Codex</a>
            <a routerLink="/media" class="btn">Download Poster</a>
          </div>
        </aside>
      </div>
    </section>
  </ion-content>
}